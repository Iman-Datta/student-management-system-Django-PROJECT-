<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>{{ title }}</title>
    <link
      href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.7/dist/css/bootstrap.min.css"
      rel="stylesheet" />
  </head>
  <body>
    <div class="container mt-5">
      <h1>{{ title }}</h1>
      <p class="lead">{{ message }}</p>

      <form class="row g-3" method="post" enctype="multipart/form-data">
        {% csrf_token %}

        <!-- Personal Details -->
        <h4>Personal Details</h4>
        <div class="col-md-6">
          <label for="first_name" class="form-label">First Name *</label>
          <input
            type="text"
            class="form-control"
            id="first_name"
            name="first_name"
            required />
        </div>

        <div class="col-md-6">
          <label for="last_name" class="form-label">Last Name *</label>
          <input
            type="text"
            class="form-control"
            id="last_name"
            name="last_name"
            required />
        </div>

        <div class="col-md-6">
          <label for="role" class="form-label">Select Role *</label>
          <select
            class="form-select"
            name="role"
            id="role"
            required
            onchange="toggleRoleFields()">
            <option value="" selected disabled>Choose...</option>
            <option value="student">Student</option>
            <option value="teacher">Teacher</option>
          </select>
        </div>

        <!-- Common fields -->
        <div class="col-md-6">
          <label for="email" class="form-label">Email *</label>
          <input
            type="email"
            class="form-control"
            id="email"
            name="email"
            required />
        </div>

        <div class="col-md-6">
          <label for="password" class="form-label">Password *</label>
          <input
            type="password"
            class="form-control"
            id="password"
            name="password"
            required />
        </div>

        <!-- Student Fields -->
        <div id="studentFields" style="display: none">
          <h4>Student Details</h4>

          <div class="col-md-6">
            <label for="dob" class="form-label">Date of Birth *</label>
            <input
              type="date"
              class="form-control"
              id="dob"
              name="dob"
              data-student-required />
          </div>

          <div class="col-md-6">
            <label for="mobile" class="form-label">Mobile Number *</label>
            <input
              type="number"
              class="form-control"
              id="mobile"
              name="mobile"
              data-student-required />
          </div>

          <div class="col-md-6">
            <label for="father_name" class="form-label">Father's Name *</label>
            <input
              type="text"
              class="form-control"
              id="father_name"
              name="father_name"
              data-student-required />
          </div>

          <div class="col-md-6">
            <label for="mother_name" class="form-label">Mother's Name *</label>
            <input
              type="text"
              class="form-control"
              id="mother_name"
              name="mother_name"
              data-student-required />
          </div>

          <div class="col-md-6">
            <label for="guardian_contact" class="form-label"
              >Guardian's Contact *</label
            >
            <input
              type="number"
              class="form-control"
              id="guardian_contact"
              name="guardian_contact"
              data-student-required />
          </div>

          <div class="col-md-6">
            <label for="permanent_address" class="form-label"
              >Permanent Address</label
            >
            <input
              type="text"
              class="form-control"
              id="permanent_address"
              name="permanent_address" />
          </div>

          <div class="col-md-6">
            <label for="permanent_city" class="form-label"
              >Permanent City</label
            >
            <input
              type="text"
              class="form-control"
              id="permanent_city"
              name="permanent_city" />
          </div>

          <div class="col-md-3">
            <label for="permanent_state" class="form-label"
              >Permanent State</label
            >
            <input
              type="text"
              class="form-control"
              id="permanent_state"
              name="permanent_state" />
          </div>

          <div class="col-md-3">
            <label for="permanent_zip" class="form-label">Permanent Zip</label>
            <input
              type="text"
              class="form-control"
              id="permanent_zip"
              name="permanent_zip" />
          </div>

          <div class="col-md-6">
            <label for="current_address" class="form-label"
              >Current Address</label
            >
            <input
              type="text"
              class="form-control"
              id="current_address"
              name="current_address" />
          </div>

          <div class="col-md-6">
            <label for="current_city" class="form-label">Current City</label>
            <input
              type="text"
              class="form-control"
              id="current_city"
              name="current_city" />
          </div>

          <div class="col-md-3">
            <label for="current_state" class="form-label">Current State</label>
            <input
              type="text"
              class="form-control"
              id="current_state"
              name="current_state" />
          </div>

          <div class="col-md-3">
            <label for="current_zip" class="form-label">Current Zip</label>
            <input
              type="text"
              class="form-control"
              id="current_zip"
              name="current_zip" />
          </div>
        </div>

        <!-- Teacher Fields -->
        <div id="teacherFields" style="display: none">
          <h4>Teacher Details</h4>

          <div class="col-md-6">
            <label for="department" class="form-label">Department *</label>
            <input
              type="text"
              class="form-control"
              id="department"
              name="department"
              data-teacher-required />
          </div>

          <div class="col-md-6">
            <label for="subject_specialization" class="form-label"
              >Subject Specialization *</label
            >
            <input
              type="text"
              class="form-control"
              id="subject_specialization"
              name="subject_specialization"
              data-teacher-required />
          </div>

          <div class="col-md-6">
            <label for="proof_document_upload" class="form-label"
              >Proof Document *</label
            >
            <input
              type="file"
              class="form-control"
              id="proof_document_upload"
              name="proof_document_upload"
              data-teacher-required />
          </div>

          <div class="col-md-6">
            <label for="gender" class="form-label">Gender *</label>
            <select
              class="form-select"
              name="gender"
              id="gender"
              data-teacher-required>
              <option value="">Select</option>
              <option value="Male">Male</option>
              <option value="Female">Female</option>
              <option value="Other">Other</option>
            </select>
          </div>
        </div>

        <!-- Buttons -->
        <div class="col-12">
          <button type="submit" class="btn btn-primary">Submit</button>
          <button
            type="button"
            class="btn btn-secondary"
            onclick="window.location.href='/'">
            Cancel
          </button>
        </div>
      </form>

      <!-- Alerts -->
      {% if success %}
      <div class="alert alert-success mt-3">
        <p>{{ message }}</p>
        {% if reg_number %}
        <h5>Registration Number: {{ reg_number }}</h5>
        <h5>Password: {{ password }}</h5>
        {% endif %}
      </div>
      {% elif error %}
      <div class="alert alert-danger mt-3">{{ message }}</div>
      {% endif %}
    </div>

    <!-- JavaScript -->
    <script>
      function toggleRoleFields() {
        const role = document.getElementById("role").value;
        const studentFields = document.getElementById("studentFields");
        const teacherFields = document.getElementById("teacherFields");

        // Hide both first
        studentFields.style.display = "none";
        teacherFields.style.display = "none";

        // Disable all required fields
        studentFields
          .querySelectorAll("[required]")
          .forEach((el) => (el.required = false));
        teacherFields
          .querySelectorAll("[required]")
          .forEach((el) => (el.required = false));

        if (role === "student") {
          studentFields.style.display = "block";
          studentFields
            .querySelectorAll("[data-student-required]")
            .forEach((el) => (el.required = true));
        } else if (role === "teacher") {
          teacherFields.style.display = "block";
          teacherFields
            .querySelectorAll("[data-teacher-required]")
            .forEach((el) => (el.required = true));
        }
      }
    </script>

    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.7/dist/js/bootstrap.bundle.min.js"></script>
  </body>
</html>
